# ChatGPT_QA

# Question Answering Project

This project demonstrates a question answering system using OpenAI's GPT-3.5 model. It includes three main files:

1. `prepare_file.py`: This script prepares the data for question answering by generating embeddings for each question in the dataset. It requires a CSV file named `questions.csv` with a column named 'Combined' that contains the merged question and answer data. The embeddings are saved in a new CSV file named `trial.csv`.

2. `main.py`: This script implements a Flask application that provides an API endpoint for answering questions based on the prepared embeddings. It uses the `trial.csv` file generated by `prepare_file.py` to find similar questions and generates answers using the GPT-3.5 model.

3. `apps_script.js`: This script is intended to be run in the Apps Script editor of Google Sheets. It defines a custom function `ans()` that fetches the answer for a given question from the Flask application's API endpoint and returns it.

## Prerequisites

- Python 3.x
- OpenAI Python SDK
- pandas
- Flask
- pyngrok
- Google Sheets

## Setup

1. Clone this repository to your local machine.

2. Set up a virtual environment (optional but recommended):

   ```bash
   $ python -m venv venv
   $ source venv/bin/activate
   ```

3. Install the required Python packages:

   ```bash
   $ pip install -r requirements.txt
   ```

4. Rename the `.env.example` file to `.env` and update the `API_KEY` with your OpenAI API key.

5. Prepare the data by running `prepare_file.py`:

   ```bash
   $ python prepare_file.py
   ```

6. Start the Flask application:

   ```bash
   $ python main.py
   ```

   The Flask application will run on `http://localhost:3000`.

7. Deploy the Flask application to a public URL using ngrok or any other preferred method.

8. Open your Google Sheets document, go to the Apps Script editor, and paste the contents of `apps_script.js` into the editor.

9. Update the `url` variable in `apps_script.js` with the URL of your deployed Flask application.

10. Save the Apps Script and exit the editor.

## Usage

1. In your Google Sheets document, use the `=ans()` function to fetch answers for questions. For example, in a cell, enter `=ans("What is the capital of France?")` or `=ans(A1)` to pass the question from cell A1.

2. The custom `ans()` function will call the Flask application's API endpoint, retrieve the answer, and display it in the cell.

3. You can change the question and rerun the function to get different answers.
